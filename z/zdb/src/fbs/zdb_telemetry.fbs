include "zfb_types.fbs";
include "zdb_cache_mode.fbs";
include "zdb_host_state.fbs";
namespace Ztel.fbs;
struct DBCacheStats {
  count:uint32;
  loads:uint64;
  misses:uint64;
  evictions:uint64;
}
table DBTable {
  name:string;
  n_shards:uint32;
  thread:[string];
  count:uint64;
  cache_stats:[DBCacheStats];   // one per shard
  cache_size:uint32;
  cache_mode:DBCacheMode;
  warmup:uint8;
}
table DBHost {
  ip:Zfb.IP;
  id:Zfb.ID;
  priority:uint32;
  port:uint16;
  state:DBHostState;
  voted:uint8;
}
table DB {
  thread:string;
  self:Zfb.ID;
  leader:Zfb.ID;
  prev:Zfb.ID;
  next:Zfb.ID;
  n_cxns:uint32;
  heartbeat_freq:uint32;
  heartbeat_timeout:uint32;
  reconnect_freq:uint32;
  election_timeout:uint32;
  n_tables:uint16;
  n_hosts:uint8;
  n_peers:uint8;
  state:int8;		// same as hosts[hostID].state
  active:uint8;
  recovering:uint8;
  replicating:uint8;
}
